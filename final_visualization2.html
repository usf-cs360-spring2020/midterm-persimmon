<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Persimmon</title>

    <!-- Load Bulma from CDN (consider saving it to repository instead) -->
    <!-- https://bulma.io/ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css">

    <!-- Load Font Awesome 5 (free) icons -->
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>

    <!-- include d3.js v5 -->
    <script src="https://d3js.org/d3.v5.min.js"></script>

    <!-- include d3.js modules -->
    <script src="https://d3js.org/d3-time.v1.min.js"></script>
    <script src="https://d3js.org/d3-time-format.v2.min.js"></script>
    <script src="https://d3js.org/d3-array.v2.min.js"></script>
    <script src="https://d3js.org/d3-fetch.v1.min.js"></script>
    <script src="d3-tip.js"></script>
    <!-- custom css -->
    <link rel="stylesheet" href="kai_style.css">

  </head>

  <body>

  <!-- Page header -->
  <!-- https://bulma.io/documentation/layout/hero/ -->
  <section class="hero is-primary is-bold">
    <div class="hero-body">
      <div class="container">
        <h1 class="title">Persimmon</h1>
        <h2 class="subtitle">Welcome to the home of team Persimmon's data visualization midterm project!</h2>
      </div>
    </div>
  </section>
  <!-- End page header -->

  <!-- Page navigation -->
  <!-- https://bulma.io/documentation/components/navbar/ -->
  <nav class="navbar is-light" role="navigation" aria-label="main navigation">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item" href="index.html">
          <span class="icon"><i class="fas fa-home"></i></span>
          <span>Home</span>
        </a>

        <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="main-menu">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>

      <div id="main-menu" class="navbar-menu has-text-weight-medium">
          <!-- Left navbar items -->
          <div class="navbar-start">
            <!-- The data icon -->
            <a class="navbar-item" href="dataset.html" title="Data">
              <span class="icon"><i class="fas fa-table"></i></span>
              <span>Data</span>
            </a>

          <!-- prototypes -->
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link">
              Prototypes
            </a>
            <div class="navbar-dropdown">
              <a class = "navbar-item" href = "visualization1.html" title = "ALS Units">
                <span class="icon"><i class="fas fa-paint-brush"></i></span>
                <span>ALS Units</span>
              </a>
              <a class = "navbar-item" href = "visualization2.html" title = "Response Time">
                <span class="icon"><i class="fas fa-paint-brush"></i></span>
                <span>Response Time</span>
              </a>
              <a class = "navbar-item" href = "visualization3.html" title = "Number of Calls">
                <span class="icon"><i class="fas fa-paint-brush"></i></span>
                <span>Number of Calls</span>
              </a>
            </div>
          </div>

          <!-- visualizations -->
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link">
              Visualizations
            </a>
            <div class="navbar-dropdown">
              <a class = "navbar-item" href = "final_visualization1.html" title = "ALS Units">
                <span class="icon"><i class="fas fa-chart-bar"></i></span>
                <span>ALS Units</span>
              </a>
              <a class = "navbar-item is-active" href = "final_visualization2.html" title = "Response Time">
                <span class="icon"><i class="fas fa-chart-bar"></i></span>
                <span>Response Time</span>
              </a>
              <a class = "navbar-item" href = "number_of_calls.html" title = "Number of Calls">
                <span class="icon"><i class="fas fa-chart-bar"></i></span>
                <span>Number of Calls</span>
              </a>
            </div>
          </div>
        </div>

        <!-- Right navbar items -->
        <div class="navbar-end">
          <a class="navbar-item" href="about.html" title="About">
            <span class="icon"><i class="fas fa-info-circle"></i></span>
            <span>About</span>
          </a>
        </div>
      </div>
    </div>
  </nav>
  <!-- End page navigation -->

  <section class="section">
    <div class="container">
      <!-- Begin page content -->
      <div class="content">
        <h1 class="title">
          Visualization 2
        </h1>

        <h4>Artist: Kai Middlebrook</h4>
        <p> This visualization investigates the average on scene arrival speed by neighborhood.
          The heatmap displays the average difference between when a called is received and when a unit has arrived on scene for the SF Fire Department. The stacked bar graph below displays the average wait time by neighborhood for a specific call group. In addition, I included a stacked bar chart which shows the average wait time for each neighborhood for a specific call group. The stacked areas represents a step in the chain of events which have to occur for a fire unit to arrive on scene. The steps go in the following order: call received to dispatch, dispatch to response, response to on scene arrival time. This chart may indicate the steps causing a bottleneck in the on scene arrival times for a specific call group.    
        </p>
        <h4>Data Wrangling</h4>
        <p>This data was created on top of our dataset (<a href = "FireDepartmentCallsSelected.csv"> FireDepartmentCallsSelected.csv </a>).
          This new dataset excludes all rows with missing data (approximately 19%). In addition, 6 new columns were added:
          diff_received_to_onScene, diff_dispatch_to_onScene, diff_response_to_onScene, norm_diff_received_to_onScene, norm_diff_dispatch_to_onScene norm_diff_response_to_onScene. The columns containing diff_* calculated the difference between the on scene time and a response time metric
          (i.e. received, dispatch, response). Then the data was filtered to exclude all rows were the on scene time was before the response time metric (approximately ~0.01%). The dataset can be found here: <a href="data/avg_wait_times_by_call_type_neighborhood.csv.csv">Filtered, averaged, and normalized fire data</a>. The code to reproduce this dataset is available as a jupyter notebook:
          <a href="https://github.com/usf-cs360-spring2020/midterm-persimmon/blob/gh-pages/data_wrangling_kai.ipynb">Filtered, averaged, and normalized Fire Data Notebook</a>.
        </p>
        <h4>Encoding</h4>
        <p>For the heatmap, darker colors indicate longer wait time. For the stacked bar chart, color represents a step in the on scene arrival process.</p>
        <h4>Interactivity</h4>
        <p> Users can get information about a specific neighborhood response time for each call group by hovering their mouse over the neighborhood and call group they are interested in learning more about. This will trigger a tooltip containing detailed information about the selected cell's differences in wait times from call received to dispatch, dispatch to response, and response to on scene. In addition, the accom
        </p>
        <h4>Insights</h4>
        <p>  The visualization indicates that fire units on scene time for calls related to fire in neighborhoods such as Glen Park and Lone Mountain/USF have the largest average wait times. In other words, if there is a fire in either of these neighborhoods you
          can expect fire units to arrive later than the average on scene time. A number of factors may influence the on scene time
          such as the distance between an available fire station and the call location, accessibility of the location, etc. Both of these
          neighborhoods are very compact and located on or near hills, which may be the reason for long on scene time wait times. The stacked bar chart indicates that response to on scene tends to be the bottleneck for alarm calls.
        </p>

        <!-- D3 version -->
        <svg id="heatmap"></svg>

        <svg id='barcharts'></div>


        <script src="heatmap_kai.js"></script>

      </div>
      <!-- End page content -->
    </div>
  </section>
  <!-- Page footer -->
  <!-- https://bulma.io/documentation/layout/footer/ -->
  <footer class="footer">
    <div class="content has-text-centered is-size-7">
      <p>
        <a href="#top">
          <span class="fas fa-arrow-up"></span>
          <span class="has-text-weight-medium">Back to Top</span>
        </a>
      </p>

      <p>
        <b>Acknowledgements:<b>
          <br>
        <a href="https://github.com/usf-cs360-spring2020/midterm-persimmon" class="button is-small" style="padding-left: 1em; padding-right: 1em;">
          <i class="fab fa-github-alt"></i>&nbsp;<strong>Github</strong>
        </a>

        <a href="https://fontawesome.com/" class="button is-small" style="padding-left: 1em; padding-right: 1em;">
          <i class="fab fa-font-awesome"></i>&nbsp;<strong>FontAwesome</strong>
        </a>

        <a href="https://bulma.io" class="button is-small">
          <img src="https://bulma.io/images/made-with-bulma--semiblack.png" alt="Made with Bulma" width="128" height="24">
        </a>
      </p>
    </div>
  </footer>
  <!-- End page footer -->

  <!-- Mobile menu responsiveness -->
  <!-- https://bulma.io/documentation/components/navbar/ -->
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);

    if ($navbarBurgers.length > 0) {
      $navbarBurgers.forEach( el => {
        el.addEventListener('click', () => {
          const target = el.dataset.target;
          const $target = document.getElementById(target);
          el.classList.toggle('is-active');
          $target.classList.toggle('is-active');
        });
      });
    }
  });
  </script>
  <!-- End mobile menu responsiveness -->
  </body>
</html>
